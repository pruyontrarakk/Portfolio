<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="style.css" />
    <title>Reinforcement Learning for Foosball - Pru Yontrarak</title>

    <style>
      /* Slightly larger margins for research pages only */
      .section__work {
        width: 90vw;
        max-width: 1200px;
        padding: calc(var(--nav-height) + 1rem) 1rem 2rem 1rem;
        margin: 0 auto;
      }
      .note { background: transparent; border: 1px solid rgba(0,0,0,.1); padding: .75rem 1rem; border-radius: 10px; color: #1a1a1a; }
      :root { --text:#222; --muted:#555; --line: rgba(0,0,0,.1); }
      .kpis { display: grid; grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); gap: .75rem; margin: .5rem 0 1rem; }
      .kpi { border: 1px solid var(--line); border-radius: 10px; padding: .65rem .8rem; font-size: .95rem; color: #555; }
      .kpi strong { display:block; color: var(--text); }
      .kpi .subtle { color:#666; font-weight: 500; }
      a.kpi { text-decoration: none; display: block; color: inherit; transition: background-color 0.2s, border-color 0.2s; }
      a.kpi:hover { background-color: rgba(0,0,0,0.02); border-color: rgba(0,0,0,0.15); cursor: pointer; }
      /* Prominent top-level GitHub button */
      .cta-row { margin: .5rem 0 1rem; }
      .cta-btn { display:inline-flex; align-items:center; gap:.4rem; padding:.5rem .85rem; border-radius:999px; border:1px solid var(--primary-color-dark); background: rgba(78,53,101,0.10); color:#2d1f3d; text-decoration:none; font-weight:600; transition:background-color .2s ease, transform .1s ease; }
      .cta-btn:hover { background: rgba(78,53,101,0.16); transform: translateY(-1px); }
    </style>
  </head>
  <body>
    <nav>
      <div class="nav__content">
        <div class="logo" id="home-button"><a href="index.html#top"><span class="name"> Pru Yontrarak</span></a></div>
        <label for="check" class="checkbox" aria-label="Toggle navigation">
          <span class="hamburger" aria-hidden="true">
            <span></span>
            <span></span>
            <span></span>
          </span>
        </label>
        <input type="checkbox" name="check" id="check" />
        <ul>
          <li><a href="index.html#timeline" id="timeline-button">timeline</a></li>
          <li><a href="index.html#research" id="research-button">cs projects</a></li>
          <li><a href="index.html#work" id="work-button" >case studies</a></li>
        </ul>
      </div>
    </nav>

    

    <div class="section__work">

        <h1 class="title">Reinforcement Learning for Foosball</h1>
        <p class="description note">
          <strong>Position</strong>: Backend Engineer, Software Engineer, Project Manager
          <br>
          <strong>Type</strong>: Team project (in progress)
          <br>
          <strong>Duration</strong>: September 2025 - Present
          <br>
          <strong>Stack</strong>: Python, C++, MuJoCo, TQC, SAC, OpenCV, YOLOv11, NumPy, PyTorch, GCP
          <br> 
        </p>

        <div class="cta-row">
          <a href="https://github.com/pruyontrarakk/FoosballSimulatorProject" target="_blank" rel="noopener noreferrer" class="cta-btn">GitHub Repository</a>
        </div>

        <h1>Summary</h1>
        <div class="kpis">
          <div class="kpi">
            <strong>Algorithm integration</strong>
            Implemented TQC (distributional critics with quantile truncation) and revived SAC (Soft Actor-Critic) from existing baseline codebase.
          </div>
          <div class="kpi">
            <strong>Data pipeline</strong>
            Calibration + undistortion + ball-state extraction (OpenCV) from real gameplay footage.
          </div>
          
        </div>


        <h1 class="subtitle">Objective</h1>
        <p class="description">
          This project explores reinforcement learning for continuous control within a foosball simulation built in MuJoCo (Advanced Physics Simulation).
          We trained agents using Truncated Quantile Critics (TQC) and benchmarked against Soft Actor-Critic (SAC) from an external codebase to study policy robustness.
          We want to build a MuJoCo foosball simulation grounded in real video, then train TQC agents that outperform a SAC baseline in interception rate and control stability.
        </p>

        <h1 class="subtitle">Why TQC?</h1>
        <p class="description">
            Both SAC and TQC are continuous-control reinforcement learning algorithms. 
            However, TQC replaces scalar Q-value estimates with quantile distributions and discards the highest quantiles when computing targets, 
            statistically filtering out overestimated samples to produce smoother and more conservative value predictions.
            This is important because in foosball, the ball's movements are stochastic and the environment is noisy.

        <h1 class="subtitle">Data Pipeline Details</h1>
        <ul class="methods">
            <li><strong>Calibration:</strong> Collected checkerboard frames; estimated camera intrinsics/extrinsics (<code>K</code>, <code>rvec</code>/<code>tvec</code>) with OpenCV.</li>
            <li><strong>Undistortion:</strong> Applied lens undistortion to gameplay video using estimated parameters.</li>
            <li><strong>Ball state extraction:</strong> Computed per‑frame ball position and velocity from recordings.</li>
        </ul>

        <h1 class="subtitle">Implementation Progress</h1>
        <ul class="methods">
            <li><strong>Baseline environment (external environment):</strong> Compiled and ran the public RoboFoosball codebase to get MuJoCo environment.</li>
            <li><strong>SAC baseline (external environment):</strong> Train from the baseline codebase environment to establish control metrics on GCP.</li>
            <li><strong>TQC training (external environment):</strong> Implemented TQC and trained on the baseline codebase environment on GCP.</li>
            <li><strong>Data collection (for our own environment):</strong> Overhead videos on a physical table with varied play styles; initial calibration and ball position/velocity extraction pipeline for foosball data.</li>
        </ul>


        <h1 class="subtitle">Preliminary Results</h1>
        <ul class="methods">
            <li><strong>SAC baseline:</strong> Successfully trained on external codebase environment.</li>
            <li><strong>TQC on baseline:</strong> Successfully trained on external codebase environment.</li>
            <li><strong>Calibration:</strong> RMS reprojection error 4.56 px; mean error 0.59 px, which is adequate for plane mapping.</li>
            <li><strong>Camera intrinsics matrix:</strong><br>
            <pre style="display: inline-block; margin: 0.5rem 0; font-family: monospace; font-size: 0.9em;"><code>K = [2665.6,    0.0, 1577.0
     0.0, 2693.4, 2260.7
     0.0,    0.0,    1.0]</code></pre>
            </li>
        </ul>


        <h1 class="subtitle">Next Steps</h1>
      <ul class="methods">
        <li><strong>Build & validate our own MuJoCo environment:</strong> encode table geometry, friction/restitution; implement multi-rod control; add reset invariants.</li>
        <li><strong>Finalize data:</strong> re-collect higher-contrast footage; lock calibration/homography; utilize extracted ball position/velocity data for training.</li>
        <li><strong>Train in our own environment:</strong> run matched TQC and SAC in our own environment with extracted ball position/velocity data; report quantitative metrics.</li>
      </ul>



    </div>

    
    <footer>
      <div class="footer__content">
        <div>© Pru Yontrarak</div>
        <div class="footer__links">
          <a href="https://www.linkedin.com/in/pruyontrarak" target="_blank" rel="noopener noreferrer">LinkedIn</a>
          <a href="https://github.com/pruyontrarakk" target="_blank" rel="noopener noreferrer">GitHub</a>
          <a href="mailto:ppy2104@columbia.edu">Email</a>
        </div>
      </div>
    </footer>
  <script>
    (function(){
      var link = document.getElementById('research-button');
      if (link) link.classList.add('active');
    })();
  </script>
  </body>
  </html>
