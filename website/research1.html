<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="style.css" />
    <title>Pru Yontrarak Portfolio - Research 1</title>

    <style>
      /* Slightly larger margins for research pages only */
      .section__work {
        width: 90vw;
        max-width: 1200px;
        padding: calc(var(--nav-height) + 1rem) 1rem 2rem 1rem;
      }
    </style>
  </head>
  <body>
    <nav>
      <div class="nav__content">
        <div class="logo" id="home-button"><a href="index.html#top">êîå’û. .’ûê¶Ø</a></div>
        <label for="check" class="checkbox">
          <i class="ri-menu-line"></i>
        </label>
        <input type="checkbox" name="check" id="check" />
        <ul>
          <li><a href="index.html#research" id="research-button">cs projects</a></li>
          <li><a href="index.html#work" id="work-button" >case studies</a></li>
        </ul>
      </div>
    </nav>

    

    <div class="section__work">

        <h1 class="title">Trajectory Optimization in PDDP</h1>
        <p class="description note">
          <strong>Position</strong>: Graduate Researcher under Professor Brian Plancher
          <br>
          <strong>Institute</strong>: The Accessible and Accelerated Robotics Lab (A¬≤R Lab)
          <br>
          <strong>Duration</strong>: January 2025 - Present 
          <br>
          <strong>Tools</strong>: Python, CUDA, CursorAI
          <br> 
        </p>

        <h1 class="subtitle">SWE Highlights</h1>
        <ul class="methods">
          <li><strong>System integration:</strong> extended the lab's PDDP codebase with a modular <em>Augmented Lagrangian</em> constraint-handling component in Python/CUDA.</li>
          <li><strong>Maintainability:</strong> refactored experiment scripts and added documentation for reuse.</li>
        </ul>
        
        
        <h1 class="subtitle">Background</h1>
        <p class="description">
            Robotic trajectory optimizers often fail under hard constraints (e.g., joint limits, obstacles). This project strengthens Parallel DDP (PDDP) by evaluating constraint-handling methods to improve feasibility, stability, and speed on CPU/GPU.
          </p>

        <h1 class="subtitle">Methods</h1>
        <ul class="methods">
            <li><strong>Unconstrained (Baseline):</strong> Standard PDDP backward/forward passes with adaptive LM-style regularization; no explicit constraint terms.</li>
            <li><strong>Log Barrier:</strong> Adds barrier terms to the cost (e.g., ‚àíŒº&nbsp;‚àëlog(slack)) to discourage constraint violation; uses a decreasing barrier schedule and safeguarded step sizes.</li>
            <li><strong>Augmented Lagrangian (AL):</strong> Penalty + multipliers for state/path constraints with conservative Œº updates; enforces feasibility via violation metrics and PD-checked <code>Q<sub>uu</sub></code>.</li>
            <li><strong>Interior-Point (IP):</strong> Primal-dual formulation with slack variables; solves damped/centered subproblems to reduce KKT residuals while maintaining strict feasibility.</li>
            <li><strong>Quadratic Programming (QP):</strong> Local QP subproblems from linearized dynamics + quadratic cost; applies explicit state/box/linear constraints via batched QP solves for control updates.</li>
          </ul>

        <h1 class="subtitle">My Contributions</h1>
        <ul class="methods">
            <li>Developed and implemented the <strong>Augmented Lagrangian constraint-handling method</strong> within PDDP in both Python and CUDA, combining penalty and multiplier updates to enforce state feasibility.</li>
            <li>Designed a <strong>Œº-update rule</strong> that increased only after consecutive violations and decreased once constraints were satisfied, improving numerical stability and avoiding oscillation.</li>
            <li>Documented the implementation and benchmark results for future lab use in extending PDDP to higher-dimensional robotic systems.</li>
        </ul>
          
        <h1 class="subtitle">Python Results</h1>
        <p class="description">We are able to see that the Augmented Lagrangian method is able to converge to the solution while maintaining within the soft constraints set.</p>
      <!-- Three images side by side -->
      <div style="display:flex; flex-wrap:nowrap; gap:.5rem; margin:.5rem 0; align-items:flex-start;">
        <img src="assets/research1/position.png" class="img-fluid" style="flex:0 0 33.333%; width:33.333%;" alt="Position plot" />
        <img src="assets/research1/velocity.png" class="img-fluid" style="flex:0 0 33.333%; width:33.333%;" alt="Velocity plot" />
        <img src="assets/research1/control.png" class="img-fluid" style="flex:0 0 33.333%; width:33.333%;" alt="Control plot" />
      </div>

        <h1 class="subtitle">Next Steps</h1>
        <ul class="methods">
          <li>GPU profiling and kernel optimizations for constraint projection and residual evaluation.</li>
          <li>Batched experiments and comparisons for all constraint-handling methods.</li>
          <li>Unit tests for constraint satisfaction and CPU/GPU parity; add CI/CD for regression protection.</li>
        </ul>

    </div>

    
    <footer>
      <div class="footer__content">
        <div>¬© Pru Yontrarak</div>
        <div class="footer__links">
          <a href="https://www.linkedin.com/in/pruyontrarak" target="_blank" rel="noopener noreferrer">LinkedIn</a>
          <a href="https://github.com/pruyontrarakk" target="_blank" rel="noopener noreferrer">GitHub</a>
          <a href="mailto:ppy2104@columbia.edu">Email</a>
        </div>
      </div>
    </footer>
  <script src="sparkles.js" defer></script>
  </body>
  </html>

