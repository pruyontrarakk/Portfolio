<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script>
      // Apply saved theme ASAP to avoid flash
      (function () {
        try {
          var saved = localStorage.getItem('theme'); // 'dark' | 'light' | null
          if (saved === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
          } // default = light (your current style)
        } catch (e) {}
      })();
    </script>
    <link rel="stylesheet" href="style.css" />
    <title>Flight Optimization ‚Äî Pru Yontrarak</title>

    <style>
      :root { --text:#222; --muted:#555; --line: rgba(0,0,0,.1); }
      .section__work {
        width: 90vw;
        max-width: 1200px;
        padding: calc(var(--nav-height) + 1rem) 1rem 2rem 1rem;
        margin: 0 auto;
      }
      .note { background: transparent; border: 1px solid var(--line); padding: .75rem 1rem; border-radius: 10px; color: #1a1a1a; }
      /* Match shared page typography (use global styles) */
      /* Bullets */
      ul.methods, ul.feature-list, ul.api-list, ul.next-steps, ul.cache-list, ul.algo-list, ul.meta-list, ul.roadmap-list {
        list-style-position: outside;
        padding-left: 1.25rem;
        margin: .25rem 0 .75rem 0;
      }
      ul li { margin-bottom: .35rem; }
      ul li code { display: inline; white-space: normal; }
      code { background: rgba(0,0,0,0.05); padding: .1rem .3rem; border-radius: 4px; }
      /* KPIs */
      .kpis { display: grid; grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); gap: .75rem; margin: .5rem 0 1rem; }
      .kpi { border: 1px solid var(--line); border-radius: 10px; padding: .65rem .8rem; font-size: .95rem; color: #555; }
      .kpi strong { display:block; color: var(--text); }
      a.kpi { text-decoration: none; display: block; color: inherit; transition: background-color 0.2s, border-color 0.2s; }
      a.kpi:hover { background-color: rgba(0,0,0,0.02); border-color: rgba(0,0,0,0.15); cursor: pointer; }
      .hr { height: 1px; background: var(--line); margin: 1rem 0; }
      .skills { color:#666; font-style: italic; margin-top:.25rem; }
      a.kicker { text-decoration: none; border-bottom: 1px solid currentColor; }
      /* Prominent top-level buttons */
      .cta-row { margin: .5rem 0 1rem; display: flex; gap: .75rem; flex-wrap: wrap; }
      .cta-btn { display:inline-flex; align-items:center; gap:.4rem; padding:.5rem .85rem; border-radius:999px; border:1px solid var(--primary-color-dark); background: rgba(78,53,101,0.10); color:#2d1f3d; text-decoration:none; font-weight:600; transition:background-color .2s ease, transform .1s ease; }
      .cta-btn:hover { background: rgba(78,53,101,0.16); transform: translateY(-1px); }
    </style>
  </head>
  <body>
    <nav>
      <div class="nav__content">
        <div class="logo" id="home-button"><a href="index.html#top">êîå’û. .’ûê¶Ø<span class="name"> Pru Yontrarak</span></a></div>
        <label for="check" class="checkbox" aria-label="Toggle navigation">
          <span class="hamburger" aria-hidden="true">
            <span></span><span></span><span></span>
          </span>
        </label>
        <input type="checkbox" name="check" id="check" />
        <ul>
          <li><a href="index.html#timeline" id="timeline-button">timeline</a></li>
          <li><a href="index.html#research" id="research-button">cs projects</a></li>
          <li><a href="index.html#work" id="work-button">case studies</a></li>
        </ul>
      </div>
        <button id="theme-toggle" class="theme-toggle" type="button" aria-pressed="false" aria-label="Toggle dark mode">
          <span class="tt-icon" data-sun="‚òÄÔ∏é" data-moon="üåô">üåô</span>
        </button>
    </nav>

    <main class="section__work">
      <h1 class="title">Multi-City Optimized Flight Planner</h1>
      <p class="description note">
        <strong>Position</strong>: Backend Engineer, Frontend Engineer, Product Lead<br>
        <strong>Type</strong>: Personal project<br>
        <strong>Duration</strong>: Sep 2025 ‚Äì Present<br>
        <strong>Stack</strong>: <em>Backend</em> ‚Äî Python ¬∑ FastAPI ¬∑ Uvicorn ¬∑ Requests ¬∑ LRU cache, <em>Frontend</em> ‚Äî React<br>
        <strong>Skills</strong>: API design, caching, optimization, constraint modeling, BFS search, caching, UI
      </p>

      <div class="cta-row">
        <a href="https://optimafly.com/" target="_blank" rel="noopener noreferrer" class="cta-btn">Live Website</a>
      </div>

      <h1>Summary</h1>
      <div class="kpis">
        <div class="kpi">
          <strong>‚âà30% speed up</strong>
          Optimization: skip dead-end airport queries after 3 consecutive no-connection days.
        </div>
        <div class="kpi">
          <strong>24h timeline cache</strong>
          Per-session TTL to avoid refetching identical legs within a day.
        </div>
        <div class="kpi">
          <strong>BFS reachability</strong>
          Supports both direct and indirect flights in real time (no offline pre-processing).
        </div>
        <a href="https://optimafly.com/" target="_blank" rel="noopener noreferrer" class="kpi">
          <strong>Deployment</strong>
          FastAPI backend deployed with Uvicorn; React frontend served via static hosting.
        </a>
      </div>

      <div class="hr"></div>

      <h1 class="subtitle">Objective</h1>
      <p class="description">
        Construct flexible, cost-minimized itineraries given travel windows, stay durations, and required or optional destinations. Treat the itinerary as a constraint-optimization task so the system finds the most cost-efficient multi-city plan that fits the schedule and is the lowest-cost option.
      </p>

      <h1 class="subtitle">Why This Project?</h1>
      <p class="description">
        We want to travel and gain as many new experiences as possible on tight budgets and narrow windows. Current tools assume fixed destinations or single routes, which breaks down when the goal is flexible exploration across multiple cities. This project fixes that by letting you specify time windows; must vs. optional cities; and min/max stay days so the system searches and builds a plan that actually fits your constraints.
      </p>

      <h1 class="subtitle">Algorithms</h1>
      <ul class="algo-list">
        <li><strong>Greedy baseline:</strong> Rejected due to local-minima behavior; produced suboptimal downstream legs that we not always feasible given user travel time constraint.</li>
        <li><strong>Top-K nearest neighbors + Beam Search (current):</strong> Chooses the cheapest <em>K</em> legs (sorted by price) and breaks ties by earliest arrival time.
          <ul>
            <li><strong>K:</strong> number of cheapest candidate legs to consider at each step (per alias-expanded O/D).</li>
            <li><strong>BEAM:</strong> beam width (keeps BEAM best partial sequences per layer).</li>
          </ul>
        </li>
      </ul>

      <h1 class="subtitle">Endpoints</h1>
      <ul class="api-list">
        <li><code>POST /optimize_beam</code> ‚Äî current optimizer (Top-K + Beam).</li>
        <li><code>POST /optimize_v0</code> ‚Äî greedy (no longer used).</li>
        <li><code>GET /city-groups</code> ‚Äî given a city name, returns airport codes (handles aliases / metro areas).</li>
        <li><code>GET /airport-codes</code> ‚Äî API data is based on city; parse data and get the airport codes that match the city.</li>
      </ul>

      <h1 class="subtitle">Cache</h1>
      <ul class="cache-list">
        <li>Caches the past 24 hours of timeline data per backend session (TTL 24h). 24 hour is currently a placeholder; it will be replaced with dynamic TTL that matches external API.</li>
        <li><strong>Optimization:</strong> Skip airports with no connections after 3 consecutive no‚Äëconnection days (~30% speedup).</li>
        <li>Attaches basic diagnostics alongside prices in cached payloads.</li>
      </ul>

      <h1 class="subtitle">Reachability Gate</h1>
      <ul class="meta-list">
        <li>No offline preprocessing, so the reachability is computed in real time.</li>
        <li>Breadth-first search over a connection map supports both direct and multi-leg routes.</li>
        <li>BFS explores airport pairs layer-by-layer to determine connectivity, enabling reliable detection of transfer paths.</li>
      </ul>

      <h1 class="subtitle">Key Features</h1>
      <ul class="feature-list">
        <li><strong>Heuristic optimization:</strong> Graph-based solver that generates feasible, low-cost itineraries under user constraints.</li>
        <li><strong>Structured API:</strong> JSON inputs for windows, stay durations, and must/optional city sets; ranked plans with simple diagnostics.</li>
        <li><strong>Interactive frontend:</strong> React UI to create, submit, and visualize candidate itineraries; tie-breakers surfaced (earliest arrival).</li>
      </ul>

      <h1 class="subtitle">Next Steps</h1>
      <ul class="roadmap-list">
        <li>Implement optimization preference in the future (e.g., price vs. time vs. stops).</li>
        <li>We need to figure out a smarter way to reduce the API call; we don‚Äôt want to rely on this API in the future (do web scraping to Google Flights).</li>
        <li>Want the airline website to be integrated so that you can click on it and buy the tickets on the official airline website or Expedia.</li>
        <li>Add a feature that lets users choose between two locations, and the system selects the optimal one.</li>
        <li>Harden error handling, caching, and performance for larger searches and heavier usage.</li>
      </ul>
    </main>

    <footer>
      <div class="footer__content">
        <div>¬© Pru Yontrarak</div>
        <div class="footer__links">
          <a href="https://www.linkedin.com/in/pruyontrarak" target="_blank" rel="noopener noreferrer">LinkedIn</a>
          <a href="https://github.com/pruyontrarakk" target="_blank" rel="noopener noreferrer">GitHub</a>
          <a href="mailto:ppy2104@columbia.edu">Email</a>
        </div>
      </div>
    </footer>

    <script>
      (function(){
        var link = document.getElementById('research-button');
        if (link) link.classList.add('active');
      })();
    </script>
    <script>
  (function () {
    var root = document.documentElement;
    var btn = document.getElementById('theme-toggle');
    if (!btn) return;

    function isDark() { return root.getAttribute('data-theme') === 'dark'; }
    function setTheme(next) {
      if (next === 'dark') root.setAttribute('data-theme', 'dark');
      else root.removeAttribute('data-theme'); // back to light defaults
      try { localStorage.setItem('theme', next); } catch (e) {}
      // update aria + icon
      btn.setAttribute('aria-pressed', String(next === 'dark'));
      var icon = btn.querySelector('.tt-icon');
      if (icon) icon.textContent = next === 'dark' ? icon.dataset.sun : icon.dataset.moon;
    }

    // Init from storage (head script already applied attribute; just sync UI)
    setTheme(localStorage.getItem('theme') === 'dark' ? 'dark' : 'light');

    btn.addEventListener('click', function () {
      setTheme(isDark() ? 'light' : 'dark');
    });
  })();
</script>

  </body>
</html>
